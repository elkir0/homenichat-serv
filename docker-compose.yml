services:
  homenichat-serv:
    build: .
    container_name: homenichat-serv
    restart: unless-stopped
    ports:
      - "${FRONTEND_PORT:-8080}:80"
      - "3001:3001"
    environment:
      - NODE_ENV=production
      - PORT=3001
      - JWT_SECRET=homenichatSecretKey2026
      # SMS Bridge - OBLIGATOIRE pour les SMS
      - PWA_API_TOKEN=njSm4xHAbYF3UnBe2Rv69aClBYFwmlWH5_zy8gQNnzQ
      - SMS_BRIDGE_URL=https://192.168.1.155:8443
      # Evolution API (optionnel)
      - EVOLUTION_API_URL=http://192.168.1.141:8080
      - EVOLUTION_API_KEY=MySecureEvolutionKey2025
      - INSTANCE_NAME=homenichat
      # Configuration VoIP - FreePBX WebRTC (extension 200)
      - VOIP_SIP_SERVER=${VOIP_SIP_SERVER:-wss://rtc.chirosteo-guadeloupe.com/ws}
      - VOIP_DOMAIN=${VOIP_DOMAIN:-192.168.1.160}
      - VOIP_USER=${VOIP_USER:-200}
      - VOIP_PASSWORD=${VOIP_PASSWORD:-webrtc200pwd}
      # Configuration AMI - FreePBX (appels entrants)
      - AMI_ENABLED=true
      - AMI_DEBUG=true
      - AMI_HOST=192.168.1.160
      - AMI_PORT=5038
      - AMI_USERNAME=homenichat
      - AMI_PASSWORD=Homenichat@AMI2026
    volumes:
      - ./data:/app/data
      - ./backend/sessions:/app/backend/sessions
